name: hod
version: 1
purpose: "Compute the Halo Occupation Distribution and/or the Luminosity Function, given a set
        of HOD parameters. See Cacciato et al. 2009 for more details on the theoretical modelling"
url: ""
interface: hod.py
attribution: ["Maria Cristina Fortuna"]
rules: []
cite: []
assumptions:
    - "See Tinker et al. 2010 for ranges of validity and relevant assumptions."

explanation: |
    "CosmoSiS module to compute the halo occupation distribution (HOD) given the conditional
    luminosity function, as described in Cacciato et al. 2009,2013. The functions that describes
    the predictions of the conditional luminosity function are computed in lf_lib_simps.py

    The halo occupation distribution predicts the number of galaxies that populate a halo of mass M:
    N_gal(M) = N_cen(M) + N_sat(M)

    In this formalism, such prediction comes from the conditional luminosity function
    which describes the number of galaxies of luminosity L in [L-dL/2, L+dL/2] in a halo of mass M,
    Phi(L|M). The number of galaxies is then given by

    N_j(M,z) = \int \Phi_j(L|M) n(M,z) dL 

    where j=cen,sat.
    "

# List of parameters that can go in the params.ini file in the section for this module    
params: 
    magnitude_z: "logical, compute the hod for varying magnitude bins"
    magnitude_file: "string, read only if magnitude_z=True. 
                    File containing the ranges in magnitudes for the different redshift bins 
                    Format: z, min_abs_mag, max_abs_mag
                    Extension: .txt"
    min_abs_mag: "real, minimum absolute magnitude to evaluate the CLF
                    Read only if magnitude_z=False"
    max_abs_mag: "real, maximum absolute magnitude to evaluate the CLF 
                    Read only if magnitude_z=False"
    zmax: "real, max redshift value. Read only if magnitude_z=False"
    nz: "integer, number of z values. Read only if magnitude_z=False"
    zmin: "real, min redshift value, Read only if magnitude_z=False"
    zmax: "real, max redshift value"
    abs_mag_sun: "real, absolute magnitude of the Sun to convert magnitudes into luminosities"
    log_mass_max: "real, log10 of the maximum mass to evaluate the HOD"
    log_mass_min: "real, log10 of the minimum mass to evaluate the HOD"
    nmass: "integer, number of mass bins"
    z_median: "real, median redshift of the sample. Used to evaluate the luminosity function"
    do_hod: "logical, compute the halo occupation distribution"
    do_number_density: "logical, compute the galaxy number density through the hod formalism"
    do_galaxy_linear_bias: "logical, compute the galaxy linear bias"
    do_luminosity_function: "logical, compute the luminosity function"
    do_clf_quantities: "logical, compute a number of ancillary quantities such as the CLF of
                    centrals and satellites, the central and satellite fractions etc. Useful
                    for testing purposes. Works only if do_luminosity_function=True"
    rescale_to_h: "logical, allow to rescale the luminosities for different values of h. Still
                    to be properly implemented. Leave False at the moment."
     

#Inputs for a given choice of a parameter, from the values.ini or from other modules
#If no such choices, just do one of these omitting mode=something part:
inputs:
    cosmological_parameters:
        omega_m: "real, cold dark matter density fraction today"
        h0: "real, Hubble parameter H0/100 (km/s/Mpc). Only needed if rescale_to_h=True"
	hod_parameters:
	    lgl0: "real, log10 of the characteristic luminosity of the central galaxies (C13, eq 4)."
	    lgm1: "real, log10 of the characteristic mass scale (C13, eq. 6)"
	    g1: "real, slope gamma_1 of the power law (C13, eq 6)"
	    g2: "real, slope gamma_2 of the power law (C13, eq 6)"
	    scatter: "real, variance of the log-normal distribution that describes the CLF of 
	                the central galaxies (C13, eq 4)"
        alfa_s: "real, slope in the modified Schechter function that describes the CLF of
                    satellite galaxies (C13, eq 5)"
	    b0: "real, parameter in the normalisation of the CLF of satellite galaxies (C13, eq 9)"
	    b1: "real, parameter in the normalisation of the CLF of satellite galaxies (C13, eq 9)"
	    b2: "real, parameter in the normalisation of the CLF of satellite galaxies (C13, eq 9)"
    hmf:
        m_h: "1D real vector, log-spaced halo masses in M_sun/h"
        z: "1D real vector, redshift"
        dndlnmh: "2D real vector, the halo mass function dn_dlnM"
    halobias:
        m_h: "1D real vector, log-spaced halo masses in M_sun/h. Needed only if do_number_density=True"
        z: "1D real vector, redshift. Needed only if do_number_density=True"
        b_hb: "2D real vector, the halo bias function b(M). Needed only if do_number_density=True"

outputs:
    hod:
        mass: "1D real vector, log-spaced halo masses in M_sun/h"
        z: "1D real vector, redshift"
        n_sat: "2D real vector, expected number of satellite galaxies that populates a halo of mass M
                at redshift z. Only if do_hod=True"
        n_cen: "2D real vector, expected number of central galaxies that populates a halo of mass M
                at redshift z. Only if do_hod=True"
        n_tot: "2D real vector, expected number of galaxies that populates a halo of mass M
                at redshift z. Only if do_hod=True"
        number_density_cen: "1D real vector. Number density of central galaxies as a function of redshift.
                Only if do_number_density=True"
        number_density_sat: "1D real vector. Number density of satellite galaxies as a function of redshift.
                Only if do_number_density=True"
        number_density_tot: "1D real vector. Number density of galaxies as a function of redshift.
                Only if do_number_density=True"
        central_fraction: "1D real vector. Fraction of central galaxies as a function of redshift.
                Only if do_number_density=True"
        satellite_fraction: "1D real vector. Fraction of satellite galaxies as a function of redshift.
                Only if do_number_density=True"
    galaxy_bias:
        galaxy_bias_centrals: "1D real vector. Central galaxy bias as a function of redshift.
                Only if do_galaxy_linear_bias=True"
        galaxy_bias_satellites: "1D real vector. Satellite galaxy bias as a function of redshift.
                Only if do_galaxy_linear_bias=True"
        b: "1D real vector. Linear galaxy bias as a function of redshift. Only if do_galaxy_linear_bias=True"
    luminosity_function:
        lum: "1D real vector, galaxy luminosities in units of L_sun/h2. Only if do_luminosity_function=True"
        lf_l: "1D real vector, galaxy luminosity function. Only if do_luminosity_function=True"
        mr: "1D real vector, galaxy absolute magnitudes (assuming h=1). Only if do_luminosity_function=True"
        lf_mr: "1D real vector, galaxy luminosity function in magnitudes. Only if do_luminosity_function=True"
        mass: "1D real vector, log-spaced halo masses in M_sun/h. Only if do_luminosity_function=True"
        lc: "1D real vector, log-spaced luminosity of the central galaxies as a function of mass. 
                Only if do_luminosity_function=True"
    conditional_luminosity_function:
        phi_star: "1D real vector, normalisation of the CLF of the satellite galaxies (C13, eq 9)
                Only if do_clf_quantities=True"
        lf_cen_mags: "1D real vector, luminosity function of the central galaxies. Only if do_clf_quantities=True"
        lf_sat_mags: "1D real vector, luminosity function of the satellite galaxies. Only if do_clf_quantities=True"
        lum: "1D real vector, galaxy luminosities in units of L_sun/h2. Only if do_clf_quantities=True"
        mass: "1D real vector, log-spaced halo masses in M_sun/h"
        clf_cen: "2D real vector, conditional luminosity function of central galaxies. Only if do_clf_quantities=True"
        clf_sat: "2D real vector, conditional luminosity function of satellite galaxies. Only if do_clf_quantities=True"
        central_fraction_l: "1D real vector. Fraction of central galaxies as a function of luminosity. 
                Only if do_clf_quantities=True"
        satellite_fraction_l: "1D real vector. Fraction of central galaxies as a function of luminosity.
                Only if do_clf_quantities=True"

