[DEFAULT]
cosebis_path = /path/to/cosebis/
outputDirectory= /path/to/output/
cosmosis_standrad_library_path=/path/to/standard/library/
tmin=0.5
tmax=250.0
nmax=20
; multiple bins
;nz_file_name=y1_redshift_distributions_v1.fits
; one bin
nz_file_name=DES-y1_mcal_1bin.fits
nBins_in = 4
RUN_NAME = %(VALUES_NAME)s_%(SAMPLER_NAME)s_nBins_%(nBins_in)s

[runtime]
; The test sampler just runs a single parameter set
sampler = test


; The output section describes where to save the results of the sampling. Not all samplers use this facility 
;- for example, the test and maxlike samplers produce only a single value and so do not need an output file. 
[output]
filename = cosebis_DESy1_theory_tomo.txt
format = text
verbosity= debug

; verbosity	Choose from "silent", "quiet", "gentle", "standard", "noisy", "debug", 
; and "highest" to get different amounts of output. Not all the printing code uses this mechanism so we need to improve it.

[test]
save_dir=%(outputDirectory)s/COSEBIS_predictions/
fatal_errors=T

; The pipeline section contains information
; that describes the sequence of calculations
; to be done and what we want out at the end
[pipeline]
quiet = T
timing = F
debug = F
modules = consistency camb halofit growth extrapolate fits_nz source_photoz_bias  IA ia_z_field pk_to_cl add_intrinsic shear_m_bias cosebis
values = %(cosebis_path)s/DESy1Inputs/values_bestfit.ini
;priors = %(cosebis_path)s/prior.ini
; extra_output = cosmological_parameters/sigma_8
; 1) consistency: calculate the simply derived cosmological parameters (e.g. omega_c = omega_m-omega_b)
; 2) camb: run the Boltzmann code to get the matter power spectrum
; 4) halofit: get the nonlinear matter power spectrum 
; 5) extrapolate: extend the power spectra to high k
; 6) load_nz: get the photometric n(z) 
; 7) photoz_bias: apply the bias parameters for the photo-z to estimate the underlying model n(z) 
; 8) nonlinear_linear_alignment: use the NLA model to get intrinsic alignment 3D power spectra 
; 9) shear_shear: convert the 3D spectra into 2D tomographic C_ell with the Limber approximation
; 10) add_intrinsic: combine the intrinsic and shear terms together into the total observable C_ell
; 11) shear_m_bias: apply the shear measurement bias to predict the measured C_ell 
; 12) cosebis: finds COSEBIs En from C_ell

likelihoods = 
extra_output = 


[consistency]
file = %(cosmosis_standrad_library_path)s/cosmosis-standard-library/utility/consistency/consistency_interface.py

[camb]
file = %(cosmosis_standrad_library_path)s/cosmosis-standard-library/boltzmann/camb/camb.so
mode = all
lmax = 2500
feedback = 0
kmin = 1e-5
kmax = 10.0
nk = 200


[halofit_takahashi]
file = %(cosmosis_standrad_library_path)s/cosmosis-standard-library/boltzmann/halofit_takahashi/halofit_interface.so
nk = 700

;dont think this makes a difference!
[growth]
file = %(cosmosis_standrad_library_path)s/cosmosis-standard-library/structure/growth_factor/interface.so
zmin = 0.
zmax = 4.
nz = 401

[extrapolate]
file = %(cosmosis_standrad_library_path)s/cosmosis-standard-library/boltzmann/extrapolate/extrapolate_power.py
kmax = 500.

; need to fix this it is looking for nz_"data_sets" 
[fits_nz]
file = %(cosmosis_standrad_library_path)s/cosmosis-standard-library/number_density/load_nz_fits/load_nz_fits.py
nz_file = %(cosebis_path)s/DESy1Inputs/%(nz_file_name)s
data_sets = source_mcal
prefix_section = T
prefix_extension = T

[source_photoz_bias]
file = %(cosmosis_standrad_library_path)s/cosmosis-standard-library/number_density/photoz_bias/photoz_bias.py
mode = additive
sample = nz_source_mcal
bias_section = wl_photoz_errors
interpolation = linear


[IA]
file = %(cosmosis_standrad_library_path)s/cosmosis-standard-library/intrinsic_alignments/la_model/linear_alignments_interface.py
do_galaxy_intrinsic = F
method = bk_corrected
;method: "string, choice of 'bk', 'bk_corrected', 'krhb', chooses which model to run"
;  A number of variations to the LA model have been discussed since, and this module
; implements three of them.  The history is a little convoluted as an error was found
; in early work missing a factor of (1+z), so one of our models is a corrected version
; of one of the other ones.  Our models are:
;         Bridle & King
;         Bridle & King (corrected)
;         Kirk, Rassat, Host, Bridle

[ia_z_field]
file = %(cosmosis_standrad_library_path)s/cosmosis-standard-library/intrinsic_alignments/z_powerlaw/ia_z_powerlaw.py
do_galaxy_intrinsic = F


[pk_to_cl]
file = %(cosmosis_standrad_library_path)s/cosmosis-standard-library/structure/projection/project_2d.py
ell_min = 0.1
ell_max = 5.0e5
n_ell = 400
position-shear = F
shear-shear = source_mcal-source_mcal
position-position = F
intrinsic-intrinsic = source_mcal-source_mcal
shear-intrinsic = source_mcal-source_mcal
position-intrinsic = F
verbose = F
get_kernel_peaks = F

[add_intrinsic]
file = %(cosmosis_standrad_library_path)s/cosmosis-standard-library/shear/add_intrinsic/add_intrinsic.py
shear-shear = T
perbin = F
position-shear = F

[shear_m_bias]
file = %(cosmosis_standrad_library_path)s/cosmosis-standard-library/shear/shear_bias/shear_m_bias.py
m_per_bin = True
verbose = F

[cosebis]
file = %(cosebis_path)s/libcosebis_cl.so
theta_min = %(tmin)s
theta_max = %(tmax)s
n_max = %(nmax)s
nBins = %(nBins_in)s
sigma_m = 0.023
sigma_e = 0.2840089932360903 0.2566344896292335 0.25514715012626554 0.26691557429756796 ; mean per component, needs more than one input for some reason!!
ngal_effective = 1.5099137858524687 1.5413199175708638 1.6196461014383043 0.8268988140297754 ;1/arcmin^2, needs more than one input for some reason!!
Area = 1321.0 ; in deg^2 has to be a float number, doesn't recognise int
Cov_name = %(outputDirectory)s/Covariance_nMaximum_%(nmax)s_%(tmin)s_%(tmax)s_nBins%(nBins_in)s
; the output covariances have this as their starting name, but different suffixes at the end. Use the one with _NoiseJustForNoise.
calculateCov = 1 ; calculate covariance
input_nPair_files_suffix = %(input_athena)/AthenaResults/xi  
; the input athena results with linear binning, 
; if using treecorr this needs to be tested. 
;There might be a factor of two difference when doing auto correlations
;input_nPair_files_suffix = %(INPUT_FOLDER)s/AthenaResults/xi ; the files should be called: input_nPair_files_suffix11,input_nPair_files_suffix12,input_nPair_files_suffix13, ...

