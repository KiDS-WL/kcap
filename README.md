This folder contains the '2cosmos' likelihood module to be used with the KiDS-1000 (in short: K1K) COSEBIs measurements from [K1K et al. 2020 (arXiv:20XX.YYYY)](http://adsabs.harvard.edu/abs/2020arXiv20XXYYYY). This likelihood was used in their Section X.X for a consistency analysis following the methodology developed in [Köhlinger et al. 2019 (MNRAS, 484, 3126)](http://adsabs.harvard.edu/abs/2019MNRAS.484.3126K).
The likelihood can only be run with the modified 'Monte Python 2cosmos' version of Monte Python, i.e. [montepython_2cosmos_public](https://github.com/fkoehlin/montepython_2cosmos_public) which calls two independent instances of [CLASS](https://github.com/legourg/class_public) (version >= 2.8 including the HMcode module) and required KCAP modules and which also keeps the relevant cosmological parameter dictionaries separate, so that each subset of the mutually exclusive split of the main dataset is assigned its own copy of cosmological (and nuisance) parameters. The two subsets are still coupled through their joint covariance though to properly account for their correlations. To compare the split parameters then to the joint parameters and to compare the evidences for the Bayes factor a comparison run with the regular `K1K_COSEBIs` likelihood is required within a standard [MontePython](https://github.com/brinckmann/montepython_public) and [CLASS](https://github.com/lesgourg/class_public) (version >= 2.6 and including the HMcode module) setup. The required KiDS-1000 data files can be downloaded from the [KiDS science data webpage](http://kids.strw.leidenuniv.nl/sciencedata.php) and the parameter file for reproducing the split runs of [K1K et al. 2020 (arXiv:20XX.YYYY)](http://adsabs.harvard.edu/abs/2020arXiv20XXYYYY) is supplied in the subfolder `INPUT`.

Assuming that 'montepython_2cosmos_public' (with CLASS version >= 2.8 including the HMcode module) and KCAP are set up (we recommend to use nested sampling), please proceed as follows:

1) Copy `__init__.py` and `K1K_COSEBIs_2cosmos.data` from this folder into a folder named `K1K_COSEBIs_2cosmos` within `/your/path/to/montepython_2cosmos_public/montepython/likelihoods/`.

(you can rename the folder to whatever you like, but you must use this name then consistently for the whole likelihood which implies to rename the `*.data`-file, including the prefixes of the parameters defined in there, the name of the likelihood in the `__init__.py`-file and also in the `*.param`-file.)

2) Set the path to the data folder (i.e. `KiDS-1000_DATA_RELEASE` from the tarball available from the [KiDS science data webpage](http://kids.strw.leidenuniv.nl/sciencedata.php') in `K1K_COSEBIs_2cosmos.data` and modify parameters as you please (note that everything is set up to work with `K1K_COSEBIs_2cosmos.param`).

3) Start your runs using e.g. the `K1K_COSEBIs_2cosmos.param` supplied in the subfolder `INPUT`.

4) If you publish your results based on using this likelihood, please cite [K1K et al. 2020 (arXiv:20XX.YYYY](http://adsabs.harvard.edu/abs/2020arXiv20XXYYYY) and all further references for the KiDS-1000 data release (as listed on the [KiDS science data webpage](http://kids.strw.leidenuniv.nl/sciencedata.php)). Please cite also [Koehlinger et al. 2019 (MNRAS, 484, 3126)](http://adsabs.harvard.edu/abs/2019MNRAS.484.3126K) for using the '2cosmos' version of Monte Python as well as all relevant references for the standard MontePython and CLASS.

Refer to `mpirun_with_multinest_2cosmos.sh` or `mpirun_with_polychord_2cosmos.sh` within the subfolder `INPUT` for all MultiNest or PolyChord-related settings that were used for the runs.

WARNING: This likelihood only produces valid results for `\Omega_k = 0`, i.e. flat cosmologies!
